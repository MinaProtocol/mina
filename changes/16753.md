# PR 16753: [Verification of zkapp proofs prior to block creation](https://www.notion.so/o1labs/Verification-of-zkapp-proofs-prior-to-block-creation-196e79b1f910807aa8aef723c135375a)

## Summary

This PR allow `Staged_ledger.check_commands` to have access to the transaction pool, so it can check transaction commands that all are already in the pool, which are verified, and skip verification for them(which is costly).

## Changes
- Introduce a `transaction_pool_proxy` that can pass access to `find_by_hash` in a `transaction_pool` down to `Staged_ledger.check_commands`;
- Replace `User_command_with_valid_signature.t` from `(User_command.Valid.t, hash) With_hash.t` to `(User_command_with_verification_keys.t, hash) With_hash.t` where `User_command_with_verification_keys.t` is just `User_command.Valid.t * Side_loaded_verification_key.t list`;
- Modify the verifier so it returns verification keys for a valid command that we can cache;
- Store `User_command_with_verification_keys.t` instead of `User_command.Valid.t` inside a transaction pool;
- PERF: Check commands already present in the pool so we don't calculate the verification keys twice during `Staged_ledger.check_commands`.

## Invariant Assumption:
- Assumes `Common.check` doesn't depends on the state of the staged ledger, and only depends on the command itself.
