(library
 (name ocaml_graphql_server_tests)
 (wrapped false)
 (modules echo_schema test_common test_schema abstract_test)
 (libraries
  graphql
  yojson
  graphql_wrapper
  ppx_inline_test.config
  core
  graphql_parser)
 (instrumentation
  (backend bisect_ppx))
 (inline_tests
  (flags -verbose -show-counts))
 (preprocess
  (pps ppx_inline_test ppx_assert ppx_version)))

(executable
 (name error_test)
 (modules error_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(executable
 (name argument_test)
 (modules argument_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(rule
 (alias runtest)
 (deps error_test.exe)
 (action
  (run %{deps})))

(rule
 (alias runtest)
 (deps argument_test.exe)
 (action
  (run %{deps})))

(executable
 (name variable_test)
 (modules variable_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(rule
 (alias runtest)
 (deps variable_test.exe)
 (action
  (run %{deps})))

(executable
 (name schema_test)
 (modules schema_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(rule
 (alias runtest)
 (deps schema_test.exe)
 (action
  (run %{deps})))

(executable
 (name introspection_test)
 (modules introspection_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(rule
 (alias runtest)
 (deps introspection_test.exe)
 (action
  (run %{deps})))

(executable
 (name directives_test)
 (modules directives_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(rule
 (alias runtest)
 (deps directives_test.exe)
 (action
  (run %{deps})))

(executable
 (name custom_error_test)
 (modules custom_error_test)
 (libraries
  alcotest
  core
  graphql
  graphql_parser
  graphql_wrapper
  ocaml_graphql_server_tests
  yojson)
 (instrumentation
  (backend bisect_ppx))
 (preprocess
  (pps ppx_version)))

(rule
 (alias runtest)
 (deps custom_error_test.exe)
 (action
  (run %{deps})))
