;;; each library below has an identical preprocess clause, because of this
;;; dune bug: https://github.com/ocaml/dune/issues/1946

;;; should succeed

;; expiration
(library
  (name unexpired)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules unexpired))

;; define locally
(library
  (name define_locally_good)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules define_locally_good))

;; define from scope
(library
  (name define_from_scope_good)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules define_from_scope_good))

;;; should fail

;; expiration
(library
  (name expired)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules expired))

(library
  (name expiry_in_module)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules expiry_in_module))

(library
  (name expiry_invalid_date)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules expiry_invalid_date))

(library
  (name expiry_invalid_format)
  (preprocess (pps ppx_jane ppx_deriving_yojson ppx_coda))
  (modules expiry_invalid_format))
