{{- $root := . -}}
{{- range $i, $retriever := .Values.retrievers }}
---
{{- $name := $retriever.name -}}
kind: ConfigMap
apiVersion: v1
metadata:
  name: {{ $retriever.script.configMap.name }}
  labels:
    {{- include "ci-dashboard.labels" $root | nindent 4 }}
data:
  {{ $retriever.script.name }}: |
    {{- $root.Files.Get (printf "files/%s/%s" $name $retriever.script.name) | nindent 4 }}
  requirements.txt: |
    {{- $root.Files.Get (printf "files/%s/requirements.txt" $name) | nindent 4 }}
{{- end }}